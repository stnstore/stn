<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>abelia</title>
<style>
body { font-family:"Cairo",sans-serif; background:#fff; color:#222; text-align:center; margin:0; padding:0;}
header { position:relative; }
header img { width:100%; height:150px; object-fit:cover; display:block; }
#mainFavIcon { position:absolute; top:10px; left:10px; font-size:28px; color:#f59aa6; cursor:pointer; background:rgba(255,255,255,0.8); border-radius:50%; padding:6px 10px; }
.top-bar { margin:10px; display:flex; justify-content:center; flex-wrap:wrap; align-items:center; gap:10px; }
.filters { display:flex; flex-wrap:wrap; gap:10px; justify-content:center; }
.filter-btn { display:flex; align-items:center; gap:6px; background:#fff; border:1px solid #f59aa6; color:#f59aa6; border-radius:20px; padding:6px 10px; cursor:pointer; font-size:14px; transition:0.3s; }
.filter-btn.active { background:#f59aa6; color:#fff; }
.filter-btn:hover { background:#f59aa6; color:white; }
.filter-btn img { width:50px; height:35px; border-radius:10%; object-fit:cover; }
.sort-section { display:flex; align-items:center; gap:5px; }
.sort-section select { padding:6px 10px; border-radius:10px; border:1px solid #ccc; font-size:13px; }
.grid { display:grid; grid-template-columns:repeat(2,1fr); gap:15px; padding:15px; }
.product { border:1px solid #eee; border-radius:15px; overflow:hidden; background:#fff; box-shadow:0 2px 5px rgba(0,0,0,0.1); cursor:pointer; transition:0.3s; position:relative; }
.product:hover { transform:scale(1.03); }
.product img { width:100%; height:180px; object-fit:cover; }
.product h3 { margin:10px 0 5px; color:#444; font-size:14px; }
.product p { margin:0 0 10px; color:#f59aa6; font-weight:bold; font-size:13px; }
.fav-icon { position:absolute; top:10px; left:10px; font-size:22px; cursor:pointer; z-index:2; transition:transform 0.2s,color 0.2s; }
.fav-icon.favorited { color:#f59aa6; transform:scale(1.2); animation:pulse 0.3s; }
@keyframes pulse {0%{transform:scale(1);}50%{transform:scale(1.4);}100%{transform:scale(1.2);}}
.direct-sale { position:absolute; bottom:10px; left:10px; background:#87d1be; color:white; padding:5px 10px; border-radius:10px; font-size:12px; font-weight:bold; }
.modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); justify-content:center; align-items:center; z-index:100; }
.modal-content { background:#fff; border-radius:15px; padding:20px; width:90%; max-width:420px; text-align:center; position:relative; }
.modal img { width:80%; max-height:400px; object-fit:contain; border-radius:10px; }
.close { position:absolute; top:8px; right:12px; font-size:20px; cursor:pointer; color:#555; }
.arrow { cursor:pointer; font-size:20px; margin:0 10px; color:#f59aa6; }
select { margin:8px 0; padding:8px; width:70%; border-radius:8px; border:1px solid #ccc; }
a.whatsapp { display:inline-block; background:#f59aa6; color:white; text-decoration:none; padding:10px 20px; border-radius:25px; margin-top:10px; transition:0.3s; }
a.whatsapp:hover { background:#b62c70; }
#favPage { display:none; padding-bottom:40px; }
#backHome { margin:15px; padding:8px 16px; border:none; background:#f59aa6; color:white; border-radius:20px; cursor:pointer; }
#modalFav { position:absolute; top:10px; left:10px; font-size:28px; cursor:pointer; color:white; border:2px solid #f59aa6; background:white; border-radius:0; }
#modalFav.favorited { background:#f59aa6; color:white; border:2px solid #f59aa6; }
</style>
</head>
<body>
<header>
<img src="images/Logo.jpg" alt="شعار المتجر">
<div id="mainFavIcon">❤️</div>
</header>

<div id="mainPage">
<div class="top-bar">
<div class="filters">
<div class="filter-btn active" data-cat="الكل" onclick="filterCategory('الكل', this)"><img src="images/all.jpg"><span>الكل</span></div>
<div class="filter-btn" data-cat="فساتين" onclick="filterCategory('فساتين', this)"><img src="images/dress.jpg"><span>فساتين</span></div>
<div class="filter-btn" data-cat="كنزات" onclick="filterCategory('كنزات', this)"><img src="images/blouse.jpg"><span>كنزات</span></div>
<div class="filter-btn" data-cat="اطقم" onclick="filterCategory('اطقم', this)"><img src="images/Oversize.jpg"><span>اطقم</span></div>
</div>
<div class="sort-section">
<label>ترتيب:</label>
<select id="sortSelect" onchange="sortProducts()">
<option value="none">بدون</option>
<option value="asc">الأدنى</option>
<option value="desc">االاعلى</option>
</select>
</div>
</div>
<div class="grid" id="products"></div>
</div>

<div id="favPage">
<h2 style="color:#f59aa6;">المفضلة ❤️</h2>
<div class="grid" id="favProducts"></div>
<button id="backHome" onclick="showHome()">العودة للصفحة الرئيسية</button>
</div>

<div class="modal" id="productModal">
<div class="modal-content">
<span class="close" onclick="closeModal()">&times;</span>
<div id="modalImages">
<span class="arrow" onclick="prevImage()">&#10094;</span>
<img id="modalImage" src="">
<span class="arrow" onclick="nextImage()">&#10095;</span>
</div>
<h3 id="modalName"></h3>
<p id="modalPrice"></p>
<p id="modalDesc"></p>
<select id="sizeSelect"><option value="">اختر المقاس</option></select>
<select id="colorSelect"><option value="">اختر اللون</option></select>
<div id="modalDirectSale" class="direct-sale" style="display:none;">بيع مباشر</div>
<div style="margin-top:10px;">
<span class="fav-icon" id="modalFav">❤️</span>
<a class="whatsapp" id="waLink" target="_blank">طلب عبر واتساب</a>
</div>
</div>
</div>

<script>
let products=[
{name:"كنزة صوف ملونة", price:175000, images:["images/T1-1.jpg","images/T1-2.jpg","images/T1-3.jpg"], sizes:[" L"], colors:["كحلي غامق "], category:["كنزات "], description:"كنزة صوف باكمام واسعة وياقة عالية.", sale:"بيع مباشر"},
{name:"كنزة صوف", price:150000, images:["images/T2-1.jpg","images/T2-2.jpg","images/T2-3.jpg"], sizes:[" standard"], colors:["سكري واسود"], category:["كنزات"], description:"كنزة صوف بنمط قناطر.", sale:"بيع مباشر"},
{name:"كنزة صوف", price:150000, images:["images/T3-1.jpg","images/T3-2.jpg","images/T3-3.jpg "], sizes:[" M"], colors:["زهر"], category:["كنزات"], description:"كنزة زهر مع حركة اكتاف مميزة.", sale:"بيع مباشر"},
{name:"بلوز ابيض", price:175000, images:["images/T4-1.jpg","images/T4-2.jpg","images/T4-3.jpg"], sizes:[" L"], colors:["ابيض"], category:[""], description:"بلوز ابيض مع اكمام منفوخة.", sale:"بيع مباشر"},
{name:"كنزة صوف", price:175000, images:["images/T5-1.jpg","images/T5-2.jpg","images/T5-3.jpg"], sizes:[" L"], colors:["فيروزي "], category:["كنزات"], description:"كنزة صوف.", sale:"بيع مباشر"},
{name:"طقم", price:200000, images:["images/T6-1.jpg"], sizes:[" L"], colors:["أزرق"], category:["اطقم"], description:"طقم مريح مكون من كنزة وبنطال.", sale:"بيع مباشر"},
{name:"بنطال", price:200000, images:["images/T7-1.jpg","images/T7-2.jpg","images/T7-3.jpg"], sizes:["42"], colors:["رمادي"], category:[""], description:"بنطال شتوي بقصة مميزة.", sale:"بيع مباشر"},
{name:"كنزة صوف", price:160000, images:["images/T8-1.jpg","images/T8-2.jpg","images/T8-3.jpg"], sizes:["standard "], colors:["بني"], category:["كنزات "], description:"كنزة صوف شتوية مع اكمام منفوخة.", sale:"بيع مباشر"},
{name:"جاكيت فرو", price:225000, images:["images/T9-1.jpg","images/T9-2.jpg"], sizes:[" L"], colors:["ابيض"], category:[""], description:"جاكيت فرو ابيض اوفر سايز.", sale:"بيع مباشر"},
{name:"كنزة صوف", price:175000, images:["images/T10-1.jpg","images/T10-2.jpg","images/T10-3.jpg"], sizes:["standard "], colors:["فوشي"], category:["كنزات"], description:"كنزة صوف بطبعة مميزة.,", sale:"بيع مباشر"},
{name:"طقم قطعتين", price:225000, images:["images/T11-1.jpg","images/T11-2.jpg"], sizes:[" L"], colors:["رمادي واسود"], category:["اطقم"], description:"طقم قطعتان كنزة وتنورة بقماش مريح واطلالة عصرية ."},
{name:"فستان طويل", price:12000, images:["images/T13-1.jpg"], sizes:[" L"], colors:["احمر"], category:[ "فساتين"], description:"فستان بفصة مميزة .", sale:"بيع مباشر"},
{name:"كنزة صوف ", price:175000, images:["images/T14-1.jpg","images/T14-2.jpg","images/T14-3.jpg"], sizes:["standard "], colors:["زهر"], category:["كنزات"], description:"كنزة بقصة مميزة .", sale:"بيع مباشر"},
{name:"جاكيت صوف", price:200000, images:["images/T15-1.jpg","images/T15-2.jpg","images/T15-3.jpg"], sizes:[" L"], colors:["بيج"], category:[" "], description:"جاكيت صوف اوفر سايز .", sale:"بيع مباشر"},
{name:"كنزة صوف", price:175000, images:["images/T16-1.jpg","images/T16-2.jpg "], sizes:["Standard "], colors:["احمر"], category:["كنزات"], description:"كنزة صوف بنقشة مميزة .", sale:"بيع مباشر"},
{name:"بيجاما قطعتين", price:150000, images:["images/T17-1.jpg "], sizes:[" L"], colors:["اسود"], category:["اطقم"], description:"بيجاما من قطعتين كنزة وبنطال  .", sale:"بيع مباشر"},
{name:"كنزة صوف", price:175000, images:["images/T18-1.jpg","images/T18-2.jpg","images/T18-3.jpg","images/T18-4.jpg"], sizes:["Standard "], colors:["اصفر"], category:["كنزات"], description:"كنزة صوف باكمام منفوخة  .", sale:"بيع مباشر"},
{name:"بنطال ", price:150000, images:["images/T19-1.jpg"], sizes:["XL"], colors:["بيج "], category:["بنطال "], description:"بنطال بارجل واسعة وقصة عصرية  .", sale:"بيع مباشر"},
{name:"فستان صوف", price:20000, images:["images/T20-1.jpg","images/T20-2.jpg","images/T20-3.jpg"], sizes:[" L"], colors:["احمر"], category:["فساتين"], description:"فستان صوف بنقشة مميزة   .", sale:"بيع مباشر"},
{name:"كنزة صوف", price:175000, images:["images/T22-1.jpg","images/T22-2.jpg "], sizes:[" L"], colors:["بيج وابيض"], category:["كنزات"], description:"كنزة صوف باكمام منفوخة    .", sale:"بيع مباشر"},
{name:"جاكيت صوف", price:200000, images:["images/T23-1.jpg","images/T23-2.jpg","images/T23-3.jpg"], sizes:[" L"], colors:["فوشي "], category:[" "], description:"جاكيت صوف اوفر سايز .", sale:"بيع مباشر"},
{name:"بلوز ابيض", price:175000, images:["images/T24-1.jpg","images/T24-2.jpg","images/T24-3.jpg"], sizes:[" L"], colors:["ابيض"], category:[""], description:"بلوز ابيض مع اكمام منفوخة.", sale:"بيع مباشر"},
{name:"طقم قطعتين", price:250000, images:["images/T26-1.jpg"], sizes:[" L"], colors:["سكري"], category:["اطقم"], description:"طقم قطعتان جاكيت وتنورة بقماش مريح واطلالة عصرية .", sale:"بيع مباشر"},
{name:"طقم قطعتين", price:250000, images:["images/T27-1.jpg","images/T27-2.jpg",], sizes:[" L"], colors:["بني"], category:["اطقم"], description:"طقم قطعتان جاكيت وبنطال بطبعة مميزة واطلالة عصرية .", sale:"بيع مباشر"},
{name:"كنزة صوف", price:175000, images:["images/T28-1.jpg "], sizes:["standard "], colors:["بني "], category:["كنزات"], description:"كنزة صوف بطبعة مميزة.", sale:"بيع مباشر"},
{name:"فستان بطول متوسط", price:200000, images:["images/T29-1.jpg","images/T29-2.jpg","images/T29-3.jpg","images/T29-4.jpg"], sizes:[" XL"], colors:["موف"], category:["فساتين"], description:"فستان بطول متوسط مع ربطة عند الخصر .", sale:"بيع مباشر"},
{name:"بلوزة", price:140000, images:["images/T30-1.jpg."], sizes:[" L"], colors:["اسود"], category:["بلوزات"], description:"بلوزة عصرية بقصة مميزة  .", sale:"بيع مباشر"},
{name:"كنزة صوف", price:200000, images:["images/T30-2.jpg "], sizes:["standard "], colors:["احمر "], category:["كنزات"], description:"كنزة صوف بطبعة مميزة.", sale:"بيع مباشر"},
{name:"كنزة صوف", price:175000, images:["images/T31-1.jpg","images/T31-2.jpg","images/T31-3.jpg","images/T31-4.jpg"], sizes:["Standard "], colors:["اصفر"], category:["كنزات"], description:"كنزة صوف باكمام منفوخة  .", sale:"بيع مباشر"},
{name:"جاكيت صوف", price:200000, images:["images/T32-1.jpg","images/T32-2.jpg","images/T32-3.jpg"], sizes:[" standard"], colors:["اسود وابيض "], category:[" "], description:"جاكيت صوف باللونين الابيض والاسود .", sale:"بيع مباشر"},
{name:"كنزة صوف", price:175000, images:["images/T33-1.jpg","images/T33-2.jpg","images/T33-3.jpg"], sizes:["M "], colors:["اسود "], category:["كنزات"], description:"كنزة صوف باكتاف مكشوفة وشريطة على شكل وردة .", sale:"بيع مباشر"},
{name:"جاكيت صوف", price:200000, images:["images/T34-1.jpg","images/T34-2.jpg","images/T34-3.jpg"], sizes:[" L"], colors:["فوشي "], category:[" "], description:"جاكيت صوف اوفر سايز .", sale:"بيع مباشر"},
{name:"كنزة صوف", price:155000, images:["images/T35.jpg"], sizes:["standard "], colors:["اخضر "], category:["كنزات"], description:"كنزة صوف .", sale:"بيع مباشر"},


]
let currentCategory="الكل", currentIndex=0, currentImageIndex=0;
let favorites=JSON.parse(localStorage.getItem("favorites")||"[]");

const productsContainer=document.getElementById("products");
const favProductsContainer=document.getElementById("favProducts");
const modal=document.getElementById("productModal");
const modalImage=document.getElementById("modalImage");
const modalName=document.getElementById("modalName");
const modalPrice=document.getElementById("modalPrice");
const modalDesc=document.getElementById("modalDesc");
const sizeSelect=document.getElementById("sizeSelect");
const colorSelect=document.getElementById("colorSelect");
const waLink=document.getElementById("waLink");
const sortSelect=document.getElementById("sortSelect");
const mainPage=document.getElementById("mainPage");
const favPage=document.getElementById("favPage");
const modalFav=document.getElementById("modalFav");
const modalDirectSale=document.getElementById("modalDirectSale");
const filterButtons=document.querySelectorAll('.filter-btn');

// عرض المنتجات
function showProducts(){
    productsContainer.innerHTML="";
    let list=products.filter(p=>currentCategory=="الكل"||p.category.includes(currentCategory));
    if(sortSelect.value=="asc") list.sort((a,b)=>a.price-b.price);
    else if(sortSelect.value=="desc") list.sort((a,b)=>b.price-a.price);

    list.forEach((p,i)=>{
        const div=document.createElement("div");
        div.className="product";
        div.innerHTML=`<div class="fav-icon ${favorites.includes(p.name)?'favorited':''}">&#9825;</div>
                       <img src="${p.images[0]}">
                       <h3>${p.name}</h3>
                       <p>${p.price.toLocaleString()} ل.س</p>
                       ${p.sale==="بيع مباشر"?'<div class="direct-sale">بيع مباشر</div>':''}`;
        const favIcon=div.querySelector(".fav-icon");
        favIcon.onclick=(e)=>{
            e.stopPropagation();
            toggleFavorite(e,p.name);
        };
        div.onclick=()=>openModal(products.indexOf(p));
        productsContainer.appendChild(div);
    });
}

// تغيير حالة المفضلة
function toggleFavorite(event,name){
    const icon=event.currentTarget;
    if(favorites.includes(name)){
        favorites=favorites.filter(f=>f!==name);
        icon.classList.remove("favorited");
        icon.innerHTML="&#9825;";
    }else{
        favorites.push(name);
        icon.classList.add("favorited");
        icon.innerHTML="❤️";
    }
    localStorage.setItem("favorites",JSON.stringify(favorites));
}

// تصفية المنتجات
function filterCategory(cat,btn){
    currentCategory=cat;
    filterButtons.forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    showProducts();
}

// ترتيب المنتجات
function sortProducts(){ showProducts(); }

// إظهار صفحة المفضلة
function showFavoritesPage(){
    mainPage.style.display="none";
    favPage.style.display="block";
    favProductsContainer.innerHTML="";

    history.pushState({favPage:true}, ""); // تسجيل حالة المفضلة

    let favItems = products.filter(p => favorites.includes(p.name));
    if(favItems.length==0){
        favProductsContainer.innerHTML="<p>لا توجد منتجات في المفضلة بعد ❤️</p>";
        return;
    }
    favItems.forEach((p,i)=>{
        const div=document.createElement("div");
        div.className="product";
        div.innerHTML=`<div class="fav-icon favorited">&#10084;</div>
                       <img src="${p.images[0]}">
                       <h3>${p.name}</h3>
                       <p>${p.price.toLocaleString()} ل.س</p>
                       ${p.sale==="بيع مباشر"?'<div class="direct-sale">بيع مباشر</div>':''}`;
        const favIcon = div.querySelector(".fav-icon");
        favIcon.onclick = (e) => {
            e.stopPropagation();
            favorites = favorites.filter(f => f !== p.name);
            localStorage.setItem("favorites", JSON.stringify(favorites));
            showFavoritesPage();
        };
        div.onclick=()=>openModal(products.indexOf(p));
        favProductsContainer.appendChild(div);
    });
}

// العودة للصفحة الرئيسية
function showHome(){
    favPage.style.display="none";
    mainPage.style.display="block";
    showProducts();
}

// فتح المودال
function openModal(index){
    currentIndex=index; currentImageIndex=0;
    const p=products[index];
    modalName.textContent=p.name;
    modalPrice.textContent=p.price.toLocaleString()+" ل.س";
    modalDesc.textContent=p.description;
    modalImage.src=p.images[0];
    sizeSelect.innerHTML='<option value="">اختر المقاس</option>';
    colorSelect.innerHTML='<option value="">اختر اللون</option>';
    p.sizes.forEach(s=>sizeSelect.innerHTML+=`<option value="${s}">${s}</option>`);
    p.colors.forEach(c=>colorSelect.innerHTML+=`<option value="${c}">${c}</option>`);
    modalDirectSale.style.display=p.sale==="بيع مباشر"?"block":"none";

    modalFav.className="fav-icon "+(favorites.includes(p.name)?"favorited":"");
    modalFav.onclick=()=>{
        if(favorites.includes(p.name)) favorites=favorites.filter(f=>f!==p.name);
        else favorites.push(p.name);
        localStorage.setItem("favorites",JSON.stringify(favorites));
        modalFav.className="fav-icon "+(favorites.includes(p.name)?"favorited":"");
        showProducts();
    };

    waLink.onclick=(e)=>{
        const size=sizeSelect.value;
        const color=colorSelect.value;
        if(!size || !color){ e.preventDefault(); alert("الرجاء اختيار المقاس واللون قبل إرسال الطلب."); return; }
        let imagesText = p.images.map(img=>window.location.origin+'/'+img).join("\n");
        const message=`مرحباً، أود طلب القطعة التالية:\n${p.name}\nالمقاس: ${size}\nاللون: ${color}\nالسعر: ${p.price.toLocaleString()} ل.س\nالصور:\n${imagesText}`;
        waLink.href=`https://wa.me/963959906414?text=${encodeURIComponent(message)}`;
    };

    modal.style.display="flex";
    document.querySelectorAll(".product .fav-icon").forEach(el=>el.style.display="none");
    history.pushState({modalOpen:true},"");
}

// إغلاق المودال
function closeModal(){
    modal.style.display="none";
    document.querySelectorAll(".product .fav-icon").forEach(el=>el.style.display="block");
}

// التنقل بين الصور
function nextImage(){ const p=products[currentIndex]; currentImageIndex=(currentImageIndex+1)%p.images.length; modalImage.src=p.images[currentImageIndex]; }
function prevImage(){ const p=products[currentIndex]; currentImageIndex=(currentImageIndex-1+p.images.length)%p.images.length; modalImage.src=p.images[currentImageIndex]; }

// أيقونة المفضلة الرئيسية
document.getElementById("mainFavIcon").onclick=showFavoritesPage;

// إغلاق المودال عند الضغط خارجه
window.onclick = function(event){ if(event.target==modal) closeModal(); };

// التعامل مع زر الرجوع
window.onpopstate = function(e){
    if(modal.style.display=="flex"){ closeModal(); }
    else if(favPage.style.display=="block"){ showHome(); }
};

showProducts();
</script>
</body>
</html>
